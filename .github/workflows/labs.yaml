name: Labs
on:
  push:
  workflow_call:
jobs:
  syntax:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      # Lab1 => steps/10-syntax-lab1-action-input/testing-workflow.yml
      - name: Lab1 - default run
        uses: ./steps/10-syntax-lab1-action-input-solution
      - name: Lab1 - custom run
        uses: ./steps/10-syntax-lab1-action-input-solution
        with:
          say: GitHub Action Rocks
          eyes: oo

      # Lab2 => steps/10-syntax-lab2-action-output/testing-workflow.yml
      - name: Lab2 - run
        id: upper_action
        uses: ./steps/10-syntax-lab2-action-output-solution
        with:
          text: GitHub Action Rocks
      - name: Lab2 - output usage
        run: |
          echo "::notice ::${{ steps.upper_action.outputs.upper_text }}"

  testing-lab1:
    uses: ./.github/workflows/labs-testing-lab1.yaml

  testing-lab3:
    uses: ./.github/workflows/labs-testing-lab3.yaml

  lifecycle:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      # Lab1 => steps/50-lifecycle-lab1-marketplace/release-workflow.yml
      - name: Lab1 - default run
        uses: ./steps/50-lifecycle-lab1-marketplace

      # Lab1 solution => steps/50-lifecycle-lab1-marketplace-solution/release-workflow.yml
      - name: Lab1 - default run
        uses: ./steps/50-lifecycle-lab1-marketplace-solution

      # Lab1 => steps/50-lifecycle-lab2-dist/release-workflow.yml
      - run: |
          npm install
          npm run prepare
        shell: bash
        working-directory: ./steps/50-lifecycle-lab2-dist

      - name: Lab2 - default run
        uses: ./steps/50-lifecycle-lab2-dist
        with:
          who: Somebody
